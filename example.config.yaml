# Relay Sidecar Configuration Example

# Logging
log:
  level: "debug"
  mode: "pretty"

# Storage
storage-dir: ".data"
# circuits-dir: ""  # Optional: Path to ZK circuits directory

# API Server Configuration
api:
  listen: ":8080"
  verbose-logging: false
  http-gateway: false  # Enable HTTP/JSON REST API gateway (default: false)

# Metrics Configuration (optional)
metrics:
  listen: ":9090"
  pprof: false

# Driver Contract
driver:
  chain-id: 31337
  address: "0x4826533B4897376654Bb4d4AD88B7faFD0C98528"

# Secret Keys
secret-keys:
  - namespace: "symb"
    key-type: 0
    key-id: 15
    secret: "0xde0b6b3a7640000"
  - namespace: "evm"
    key-type: 1
    key-id: 31337
    secret: "0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80"

# Signal Configuration
signal:
  worker-count: 10
  buffer-size: 20

# Cache Configuration
cache:
  network-config-size: 10
  validator-set-size: 10

# Sync Configuration
sync:
  enabled: true
  period: 5s
  timeout: 1m
  epochs: 5

# Key Cache
key-cache:
  size: 100
  enabled: true

# P2P Configuration
p2p:
  listen: "/ip4/0.0.0.0/tcp/8880"
  bootnodes: []
  dht-mode: "disabled"
  mdns: true

# EVM Configuration
evm:
  chains:
    - "http://127.0.0.1:8545"
  max-calls: 30
  # Per-chain gas prices in wei when eth_maxPriorityFeePerGas is not supported
  # Key is chain ID, value is gas price in wei
  # Default: 2000000000 (2 GWei) if chain is not specified
  # fallback-gas-prices:
  #   "31337": 2000000000    # Local chain: 2 GWei
  #   "11155420": 1000000000 # OP Sepolia: 1 GWei

# Aggregation Policy
aggregation-policy-max-unsigners: 50

# Data Retention Configuration (optional)
# Controls how much historical data to keep on this node
retention:
  # Maximum number of historical validator set epochs to sync on fresh node startup
  # - 0 (default): Unlimited - sync from genesis epoch
  # - N > 0: Sync only the most recent N epochs
  # Note: Only applies to fresh nodes. Existing nodes continue from last synced epoch.
  # Should match your pruning retention period to avoid re-syncing pruned data.
  valset-epochs: 0

# Automatic Pruning Configuration (optional)
# Periodically deletes old epoch data to prevent unbounded storage growth
pruner:
  # Enable automatic pruning (default: false for safety)
  enabled: false

  # How often to run the pruning process (default: 1h)
  # Examples: 30m, 1h, 6h, 24h
  interval: 1h


# BadgerDB Storage Engine Tuning (optional)
# See https://github.com/dgraph-io/badger/blob/main/options.go#L123 for details
badger:
  block-cache-size: 134217728     # 128 MB (badger default: 256 MB)
  mem-table-size: 33554432        # 32 MB (badger default: 64 MB)
  num-memtables: 3                # (badger default: 5)
  num-level-zero-tables: 3        # (badger default: 5)
  num-level-zero-tables-stall: 8  # (badger default: 15)
  compact-l0-on-close: true       # (badger default: false)
  value-log-file-size: 536870912  # 512 MB (badger default: ~1 GB)

tracing:
  enabled: false
  endpoint: "localhost:4317"
  sample-rate: 1.0